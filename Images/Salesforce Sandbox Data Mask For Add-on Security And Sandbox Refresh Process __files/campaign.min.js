ccs_define("campaign",["jquery","Fancybox","babelHelpers","require","postMessage"],function(l,t,a,c,e){"use strict";var n={lightbox:"lightbox",popup:"popup"};function o(t){t.displayMode===n.lightbox&&function(t){var e={src:t.url,smallBtn:!1,touch:!1,type:"iframe",iframe:{preload:!1}};ccs_util.isMobile()?e.iframe.css={width:"100%",height:"100%","max-width":t.width+"px","max-height":t.height+"px"}:(e.width=t.width,e.height=t.height);l.fancybox.open(e)}(t),t.displayMode===n.popup&&function(t){window.open(t.url,"_blank","width=".concat(t.width,",height=").concat(t.height,",location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,toolbar=no"))}(t)}function s(t){switch(t){case"legacyOfficeUrl":return"buy-office";case"legacyWindowsUrl":return"buy-windows";case"legacyServerUrl":return"buy-server";case"legacyCloudUrl":return"buy-cloud";case"buyNowUrl":return"buy-button";case"tryNowUrl":return"try-button"}return null}function u(n,e,i){var t=".ccs-"+n;l(t+" a, a"+t).each(function(){var t=l(this);("{Value}"===t.attr("href")||t.hasClass("ccs-update-href"))&&t.attr("href",e)}).click(function(){var t=l(this).attr("href"),e={Action:"try-button"===n?"try-now":"buy-now",ActionContext:t};ccs_cc_log.dispatchEvent(i,e)}),l(t).show()}var d=".ccs-contact-button, .ccs-contact-button a",h=".ccs-contact-empty";var i=function(t){this.message=t};(i.prototype=new Error).name="InvalidCharacterError";var f=function(t){throw new i(t)},p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r=".ccs-download-button, .ccs-download-button a";function m(t,e){if(t.isEnabled){var n=l(r).filter('a[cspdoctitle]:not([cspdoctitle=""])');n&&(function(t){t.filter("a[href^='/'], a[href^='./'], a[href^='../']").each(function(){var t=l(this).attr("href"),e=t.indexOf("/")+1,n=t.substr(e);l(this).attr("href",v(n))})}(n),n.each(function(){!function(t,e,n){var i=n.context,r=n.log,o=function(t){var e=new Object,n=t.attr("href"),i=t.attr("cspdoctitle");-1===n.indexOf(window.location.host)&&(n=v(n));0<n.length&&(e.Href=n);0<i.length&&(e.Text=i);return JSON.stringify(e)}(t);if(!o)return;var a=(new Date).getTime(),c="".concat(i,"&download=").concat(function(t){t=String(t),/[^\0-\xFF]/.test(t)&&f("The string to be encoded contains characters outside of the Latin1 range.");for(var e,n=t.length%3,i="",r=-1,o=t.length-n;++r<o;)e=(t.charCodeAt(r)<<16)+(t.charCodeAt(++r)<<8)+t.charCodeAt(++r),i+=p.charAt(e>>18&63)+p.charAt(e>>12&63)+p.charAt(e>>6&63)+p.charAt(63&e);return 2==n?(e=(t.charCodeAt(r)<<8)+t.charCodeAt(++r),i+=p.charAt(e>>10)+p.charAt(e>>4&63)+p.charAt(e<<2&63)+"="):1==n&&(e=t.charCodeAt(r),i+=p.charAt(e>>2)+p.charAt(e<<4&63)+"=="),i}(encodeURIComponent(o)),"&AutoHeightId=").concat(a),s="https:"===document.location.protocol?"https:":"http:",l="".concat(s,"//").concat(ccs_cc_initParams[1]).concat(e,"?").concat(c);t.addClass("iframe").attr("href",l).fancybox({type:"iframe",smallBtn:!0,baseClass:"ccs-fancybox-dccn-features",iframe:{attr:{"data-autoheight-id":a},css:{width:430}},afterLoad:function(t,e){e.$content.css("height","auto");var n=r;ccs_cc_log.dispatchEvent(n,{Action:"download"})}})}(l(this),t.formUrl,e)}))}}function v(t){if(0<t.indexOf("//"))return t;var e=window.location.protocol+"//"+window.location.host,n=window.location.pathname,i=n.lastIndexOf("/")+1;return e+n.substr(0,i)+t}var g=".ccs-partner-name";function w(t,e){var n="&bannerId=".concat(e);t.options.context+=n;var i=t.options;t.campaignUrls&&function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var i=s(n),r=t[n];i&&r&&u(i,r,e)}}(t.campaignUrls,i.log),function(r,t){var o=t.context,a=t.log;if(!r.isEnabled)return l(h).show();var e=l(d);e.show(),e.filter("a").each(function(){var t=l(this),e=(new Date).getTime(),n="https:"===document.location.protocol?"https:":"http:",i="".concat(n,"//").concat(ccs_cc_initParams[1]).concat(r.formUrl).concat(o,"&AutoHeightId=").concat(e);t.addClass("iframe").attr("href",i).fancybox({type:"iframe",smallBtn:!0,baseClass:"ccs-fancybox-dccn-features",iframe:{attr:{"data-autoheight-id":e},css:{width:430}},afterLoad:function(t,e){e.$content.css("height","auto");var n=a;ccs_cc_log.dispatchEvent(n,{Action:"contact-us"})}})})}(t.contactUs,i),m(t.download,i),t.partnerName&&function(e){l(g).each(function(){var t=l(this);t.text(e),t.show()})}(t.partnerName)}var y=function(){function o(t,e){a.classCallCheck(this,o),this.microsite=t,this.bannerId=e;var n=l("#".concat(e)),i=n.find("script[data-id=".concat(e,"]"));c("inlineContent"),l("<div>").attr("id","ic".concat(e)).css("display","none").html(i.text().trim()).appendTo(n.parent()),i.remove();var r=n.data("ic");new Function(r.init)(),w(r.features,e),this.$content=l("#ic".concat(e)),this.$content.css("width","".concat(t.width,"px")),this.$content.css("height","100%")}return a.createClass(o,[{key:"show",value:function(){var n=this;l.fancybox.open({content:n.$content,type:"html",baseClass:"ccs-fancybox-microsite-inline",smallBtn:!1,touch:!1,trapFocus:!1,afterShow:function(){c("ElementQueries").init(n.$content.find(".ccs-cc-inline")[0]),n.slickRefreshOnResize(),n.initBackGroundVideoAutoPlay(),n.adjustFeatures(),n.adjustHotspots()},afterClose:function(){l.ccsVideoPlayer.stopAllVideos(),c("ElementQueries").detach(n.$content.find(".ccs-cc-inline")[0])},beforeClose:function(t,e){n.suppressYoutubeAutoplay()}})}},{key:"initBackGroundVideoAutoPlay",value:function(){var t=this.$content;ccs_util.isMobile()||t.find(".ccs-cc-inline-feature-background").find("video").each(function(t,e){e.play(),e.muted=!0})}},{key:"slickRefreshOnResize",value:function(){var t=this.$content.find(".ccs-slick-slider");0!==t.length&&l(document).off("ccsBreakpointFired.campaign").on("ccsBreakpointFired.campaign",function(){t.each(function(){l(this).ccsSlick("setPosition")})})}},{key:"suppressYoutubeAutoplay",value:function(){var t=this.$content;ccs_util.isMobile()||t.find("[data-video-url*='youtu']").off(".ytCampaign").one("ccsPlayer.ytCampaign",function(t){var e=l(t.target),n=e.children(".ccs-cc-inline-embedded-video-wrapper"),i=t.player;"video/youtube"===i.mejs.options.type&&e.off(".ytCampaign").on("ccsPlayer.ytCampaign",function(t){"canplay"===t.originalEvent.type&&(i.pause(),n.hide(),e.one("click.ytCampaign",function(){i.play(),n.show()}))})})}},{key:"adjustFeatures",value:function(){var t=this.$content.find(".ccs-cc-fc-items");t.length&&t.each(function(t){l(this).ccsSlick("setPosition")})}},{key:"adjustHotspots",value:function(){var n=this,i=n.$content;0!==i.find(".ccs-cc-inline-hotspots").length&&(i.on("click",".ccs-hotspots-point",function(t){i.on("scroll.qtip",function(){var t=i.find(".ccs-hotspots-point.ccs-hotspots-point-active"),e="reposition";0!==t.length&&n.isElementInViewport(t,0,i)||(e="hide",l(this).off("scroll.qtip")),t.qtip(e)})}),i.on("click",function(t){i.find(".ccs-hotspots-point").not(t.target).qtip("hide")}),l(document).on("beforeClose.ccs-fb",function(t,e,n){n.$content.find(".ccs-hotspots-point").qtip("hide"),n.$content.off("scroll.qtip")}))}},{key:"isElementInViewport",value:function(t,e,n){e=e||0;var i=l(t);if(0===i.length)return!1;var r=l(window).height(),o=l(window).scrollTop();void 0!==n&&(r-=o+=n.offset().top);var a=o<e?0:o-e,c=o+r+e,s=i.offset().top;return s+i.height()<=c&&a<=s&&i.is(":visible")}}]),o}(),b=function(){function t(t){if(window.ccsCampaignBannerListener.isInTrusted(t.origin)){var n,e=t.data,i=!0;try{(n=l.parseJSON(e)).messageType&&n.params||(i=!1)}catch(t){i=!1}if(i){var r=l.grep(window.ccsCampaignBannerListener.registeredHandlers,function(t){return t.type&&t.type===n.messageType&&t.id&&t.id===n.messageId});r&&l.each(r,function(t,e){l.isFunction(e.callback)&&e.callback(n.params)})}}}function e(){this.trustedDomains=[],this.registeredHandlers=[],window.addEventListener?window.addEventListener("message",t,!1):window.attachEvent("onmessage",t)}return e.prototype.addTrustedDomain=function(t){this.isInTrusted(t)||this.trustedDomains.push(t)},e.prototype.isInTrusted=function(t){return-1!==l.inArray(t,this.trustedDomains)},e.prototype.registerHandler=function(t,e,n){var i={id:t,type:e,callback:n};this.registeredHandlers.push(i)},e}(),x=window.ccsCampaignBannerListener=window.ccsCampaignBannerListener||new b,C={ie:"msie",chrome:"chrome",opera:"opera",safari:"safari",mozilla:"mozilla"},k={openMicrositeRequest:"openMicrositeRequest"},A={html:"html",image:"image"},B={campaignData:{fallbackEvent:"from server",imageBanner:{id:"from server",url:"from server",width:"from server",height:"from server",type:"from server",onClickLogEvent:"from server"},htmlBanner:{id:"from server",url:"from server",width:"from server",height:"from server",type:"from server",onClickLogEvent:"from server",domain:"from server"},microsite:{url:"from server",displayMode:"from-server",width:"from server",height:"from server",title:"from server"}}};function E(t){if(t){var e=function(t){return t?l.parseJSON(t):null}(t);if(e){var n=window[e.logFunctionName];n&&n(e.eventId)}}}function I(e){return l.grep(L.registeredBanners,function(t){return t.id&&t.id===e})[0]}function $(t){var e=I(t);E(e.onClickLogEvent);var n=e.microsite;if(null==n.url){var i=l("#ic".concat(t));if(0===i.length){var r=new y(n,t);(i=l("#ic".concat(t))).data("microsite",r)}i.data("microsite").show()}else o(n)}function _(){var e=function(){var t=navigator.userAgent;t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],n={browser:e[1]||"",version:e[2]||"0"},i={};return n.browser&&(n.browser!==C.chrome&&"webkit"===n.browser?i.name=C.safari:i.name=n.browser,i.version=n.version),i}(),t=[{name:C.ie,version:"9.0"},{name:C.ie,version:"8.0"},{name:C.ie,version:"7.0"},{name:C.ie,version:"6.0"},{name:C.ie,version:"5.0"}];return 0===l.grep(t,function(t){return t.name===e.name&&t.version===e.version}).length}function L(t){var e=l.extend(!0,{},B,t),n=function(t){var e=_();return e||E(t.fallbackEvent),e?t.htmlBanner||t.imageBanner:t.imageBanner||t.htmlBanner}(e.campaignData);n&&(function(t){(t||t.id)&&(I(t.id)||L.registeredBanners.push(t))}(n),function(t,e){var n=l("#"+t.id);if(n.data("ic",e),t.type===A.html){n.css({height:t.height+"px",maxWidth:t.width+"px"});var i=l('<iframe scrolling="no" frameBorder="0" title=\''+t.microsite.title+"'></iframe>").attr("src",t.url).css({width:"1px",minWidth:"100%",height:"1px",minHeight:"100%"});n.append(i),x.addTrustedDomain(t.domain),x.registerHandler(t.id,k.openMicrositeRequest,$)}if(t.type===A.image){var r=l('<a style="cursor: pointer;"></a>'),o=l('<img src="'+t.url+"\" alt='"+t.microsite.title+'\' style="border: 0;" />');r.append(o),n.append(r),r.click(function(){$(t.id)})}}(n,e.inlineContent))}return L.registeredBanners=[],window.ccsCampaignBanner=window.ccsCampaignBanner||L,{banner:L,features:w}});
//# sourceMappingURL=campaign.min.js.map
